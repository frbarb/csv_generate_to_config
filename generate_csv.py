# %%
import csv
import os
import pandas as pd


# %%
# VARIABLES - FILENAMES
inputfile = 'file.csv'
outputfile = 'output.csv'
df = pd.read_csv(inputfile, sep=",", dtype=str, low_memory=True)

# %%
print(df.head(2).to_string())

# %%
df1 = df.groupby(['uf']).size().reset_index(name='count')
print(df1)

# %%
# Total Lines
total = len(df.index)
print(f'Total lines : {total:,}')

# %%
# DEFINE UF NETWORK PARAMETERS INSIDE THE DICTIONARIES BELOW

# define states dictionaries with related info
uf = {
    1 : 'UF',
    2 : 'ROUTER1',
    3 : 'ROUTER2',
    4 : '',
    5 : '',
    6 : 'SGW',
    7 : '',
    8 : 'City',
    9 : '',
    10 : 'xxx',
    11 : 'xxx',
    12 : '',
    13 : '',
    14 : 'UF',
    15 : 'XXXX',
    16 : 'XX'} # uf

# %%
# REMOVE PREVIOUS OUTPUT FILE, IF EXISTS
try:
    os.remove(outputfile)
except OSError:
    pass

# INSERT HEADER TO BEGINNING OF OUTPUT FILE
def insert_header():
    with open(inputfile, "r") as input_file:
        with open(outputfile, "w", newline='') as output_file:
            input_file_reader = csv.reader(input_file, delimiter=',')
            header = ['F/FLOW','ACTION','Status','UNIQUE FLOW ID','FLOW ID','FLOW NAME','CIRCUIT ID 1','CIRCUIT NAME 1','FD 1/2 WAY','FDV 1/2 WAY','CUSTOMER/PROVIDER','LEVEL 1','LEVEL 2','LEVEL 3','LEVEL 4','LEVEL 5','SLA PROFILE','DEVICE LOCATION A/Z?','A/Z BOTH','A NAME','Z NAME','CIR A->Z','EIR A->Z','CIR Z->A','EIR Z->A','TEST TYPE','ENDPOINT LOGICAL NAME','ENDPOINT ROLE','ENDPOINT TYPE','ENDPOINT INTERFACE','VLAN 1 ETHERTYPE','VLAN 1 ID','RX VLAN 1 PRIORITY','PM VLAN 1 PRIORITY','VLAN 2 ETHERTYPE','VLAN 2 ID','RX VLAN 2 PRIORITY','PM VLAN 2 PRIORITY','TWAMP TX PERIOD','TWAMP FRAME SIZE','REFLECTOR IP ADDRESS','REFLECTOR SHARED IP','REFLECTOR UDP PORT','DSCP','CODEC','CONTROL SERVER IP','CONTROL SERVER PORT','KEEP ALIVE INTERVAL','SOURCE IP ADDRESS','INITIATOR SHARED IP','GATEWAY IP ADDRESS','PREFIX LENGTH','SOURCE UDP PORT','DESTINATION MAC ADDRESS','REMOTE ENDPOINT TYPE','REMOTE ENDPOINT NAME','REMOTE ENDPOINT INTERFACE','MAC ADDRESS','REMOTE MAC ADDRESS','MEP NUMERIC ID','REMOTE MEP ID','MEP STANDARD','MD NAME FORMAT','MD NAME','MEG ID FORMAT','MEG ID','MEG LEVEL','RX FILTER TYPE','CCM DEST MAC TYPE','CCM TX PERIOD','CCM VLAN 1 PRIORITY','CCM VLAN 2 PRIORITY','PM REPORT THROUGHPUT','PM SAMPLE INTERVAL','DMM TX PERIOD','SLM TX PERIOD','DMM DATA TLV SIZE','SLM DATA TLV SIZE','DERIVE 1 WAY FROM 2 WAY','FLOW_TIMEZONE','COMP THRESHOLD FWD LIMITER','A FIRMWARE VERSION','A HW VERSION','A SERIAL NUMBER','A CLLI','Z FIRMWARE VERSION','Z HW VERSION','Z SERIAL NUMBER','Z CLLI','A LOCATIONTYPE','A LOCATION ADDRESS 1','A LOCATION ADDRESS 2','A LOCATION CITY','A LOCATION STATE','A LOCATION ZIP/POSTAL CODE','A LOCATION COUNTRY','Z LOCATIONTYPE','Z LOCATION ADDRESS 1','Z LOCATION ADDRESS 2','Z LOCATION CITY','Z LOCATION STATE','Z LOCATION ZIP/POSTAL CODE','Z LOCATION COUNTRY','A LATITUDE','A LONGITUDE','A ELEVATION','Z LATITUDE','Z LONGITUDE','Z ELEVATION','A ADDRESS','A MEP ID','A MEP NAME','A PORT ID','A PORT NAME','Z ADDRESS','Z MEP ID','Z MEP NAME','Z PORT ID','Z PORT NAME','A VLAN 1 ID','A VLAN 1 PRIORITY','A VLAN 2 ID','A VLAN 2 PRIORITY','Z VLAN 1 ID','Z VLAN 1 PRIORITY','Z VLAN 2 ID','Z VLAN 2 PRIORITY']
            output_file_writer = csv.DictWriter(output_file, fieldnames=header)
            output_file_writer.writeheader()
            print(f'Processed 1 line.')

# GENERATE FLOWS FUNCTION'
def generate_flows(state):
    with open(inputfile, "r") as input_file:
        with open(outputfile, "a", newline='') as output_file:
            input_file_reader = csv.reader(input_file, delimiter=',')
            header = ['F/FLOW','ACTION','Status','UNIQUE FLOW ID','FLOW ID','FLOW NAME','CIRCUIT ID 1','CIRCUIT NAME 1','FD 1/2 WAY','FDV 1/2 WAY','CUSTOMER/PROVIDER','LEVEL 1','LEVEL 2','LEVEL 3','LEVEL 4','LEVEL 5','SLA PROFILE','DEVICE LOCATION A/Z?','A/Z BOTH','A NAME','Z NAME','CIR A->Z','EIR A->Z','CIR Z->A','EIR Z->A','TEST TYPE','ENDPOINT LOGICAL NAME','ENDPOINT ROLE','ENDPOINT TYPE','ENDPOINT INTERFACE','VLAN 1 ETHERTYPE','VLAN 1 ID','RX VLAN 1 PRIORITY','PM VLAN 1 PRIORITY','VLAN 2 ETHERTYPE','VLAN 2 ID','RX VLAN 2 PRIORITY','PM VLAN 2 PRIORITY','TWAMP TX PERIOD','TWAMP FRAME SIZE','REFLECTOR IP ADDRESS','REFLECTOR SHARED IP','REFLECTOR UDP PORT','DSCP','CODEC','CONTROL SERVER IP','CONTROL SERVER PORT','KEEP ALIVE INTERVAL','SOURCE IP ADDRESS','INITIATOR SHARED IP','GATEWAY IP ADDRESS','PREFIX LENGTH','SOURCE UDP PORT','DESTINATION MAC ADDRESS','REMOTE ENDPOINT TYPE','REMOTE ENDPOINT NAME','REMOTE ENDPOINT INTERFACE','MAC ADDRESS','REMOTE MAC ADDRESS','MEP NUMERIC ID','REMOTE MEP ID','MEP STANDARD','MD NAME FORMAT','MD NAME','MEG ID FORMAT','MEG ID','MEG LEVEL','RX FILTER TYPE','CCM DEST MAC TYPE','CCM TX PERIOD','CCM VLAN 1 PRIORITY','CCM VLAN 2 PRIORITY','PM REPORT THROUGHPUT','PM SAMPLE INTERVAL','DMM TX PERIOD','SLM TX PERIOD','DMM DATA TLV SIZE','SLM DATA TLV SIZE','DERIVE 1 WAY FROM 2 WAY','FLOW_TIMEZONE','COMP THRESHOLD FWD LIMITER','A FIRMWARE VERSION','A HW VERSION','A SERIAL NUMBER','A CLLI','Z FIRMWARE VERSION','Z HW VERSION','Z SERIAL NUMBER','Z CLLI','A LOCATIONTYPE','A LOCATION ADDRESS 1','A LOCATION ADDRESS 2','A LOCATION CITY','A LOCATION STATE','A LOCATION ZIP/POSTAL CODE','A LOCATION COUNTRY','Z LOCATIONTYPE','Z LOCATION ADDRESS 1','Z LOCATION ADDRESS 2','Z LOCATION CITY','Z LOCATION STATE','Z LOCATION ZIP/POSTAL CODE','Z LOCATION COUNTRY','A LATITUDE','A LONGITUDE','A ELEVATION','Z LATITUDE','Z LONGITUDE','Z ELEVATION','A ADDRESS','A MEP ID','A MEP NAME','A PORT ID','A PORT NAME','Z ADDRESS','Z MEP ID','Z MEP NAME','Z PORT ID','Z PORT NAME','A VLAN 1 ID','A VLAN 1 PRIORITY','A VLAN 2 ID','A VLAN 2 PRIORITY','Z VLAN 1 ID','Z VLAN 1 PRIORITY','Z VLAN 2 ID','Z VLAN 2 PRIORITY']
            output_file_writer = csv.DictWriter(output_file, fieldnames=header)
            line_count = 0
            for row in input_file_reader:
                if row[0] != '':
                    if row[3] == 'HUAWEI':
                        if row[0][-7:-5] == state[14]:
                            if "-" in state[2]:
                                value = state[2].split("-",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[1],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P1',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[10],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': row[2],
                                    'CONTROL SERVER PORT': '862',
                                    'KEEP ALIVE INTERVAL': '900',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[2][0:7] + '-EAQT01_P1',
                                    'A MEP NAME': state[2][0:7] + '-EAQT01_P1',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY' : ''
                                })
                                value = state[3].split("-",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[1],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P2',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[11],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': row[2],
                                    'CONTROL SERVER PORT': '862',
                                    'KEEP ALIVE INTERVAL': '900',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[3][0:7] + '-EAQT01_P2',
                                    'A MEP NAME': state[3][0:7] + '-EAQT01_P2',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY' : ''
                                })
                                if state[4] != '':
                                    value = state[2].split("-",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[1],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P1',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[12],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': row[2],
                                        'CONTROL SERVER PORT': '862',
                                        'KEEP ALIVE INTERVAL': '900',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[4][0:7] + '-EAQT01_P1',
                                        'A MEP NAME': state[4][0:7] + '-EAQT01_P1',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY' : ''
                                    })
                                    value = state[3].split("-",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[1],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P2',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[13],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': row[2],
                                        'CONTROL SERVER PORT': '862',
                                        'KEEP ALIVE INTERVAL': '900',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[5][0:7] + '-EAQT01_P2',
                                        'A MEP NAME': state[5][0:7] + '-EAQT01_P2',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY' : ''
                                    })
                                    line_count += 1
                                else:
                                    line_count += 1
                                    continue
                            if "." in state[2]:
                                value = state[2].split(".",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[0],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P1',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[10],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': row[2],
                                    'CONTROL SERVER PORT': '862',
                                    'KEEP ALIVE INTERVAL': '900',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[2][0:7] + '-EAQT01_P1',
                                    'A MEP NAME': state[2][0:7] + '-EAQT01_P1',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY': ''
                                })
                                value = state[3].split(".",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[0],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P2',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[11],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': row[2],
                                    'CONTROL SERVER PORT': '862',
                                    'KEEP ALIVE INTERVAL': '900',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[3][0:7] + '-EAQT01_P2',
                                    'A MEP NAME': state[3][0:7] + '-EAQT01_P2',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY': ''
                                })
                                if state[4] != '':
                                    value = state[2].split(".",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[0],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P1',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[12],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': row[2],
                                        'CONTROL SERVER PORT': '862',
                                        'KEEP ALIVE INTERVAL': '900',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[4][0:7] + '-EAQT01_P1',
                                        'A MEP NAME': state[4][0:7] + '-EAQT01_P1',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY': ''
                                    })
                                    value = state[2].split(".",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[0],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P2',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[13],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': row[2],
                                        'CONTROL SERVER PORT': '862',
                                        'KEEP ALIVE INTERVAL': '900',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[5][0:7] + '-EAQT01_P2',
                                        'A MEP NAME': state[5][0:7] + '-EAQT01_P2',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY': ''
                                    })
                                    line_count += 1
                                else:
                                    line_count += 1
                                    continue
                        else:
                            continue
                    else:
                        if row[0][-7:-5] == state[14]:
                            if "." in state[2]:
                                value = state[2].split(".",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[0],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P1',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[10],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': '',
                                    'CONTROL SERVER PORT': '',
                                    'KEEP ALIVE INTERVAL': '',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[2][0:7] + '-EAQT01_P1',
                                    'A MEP NAME': state[2][0:7] + '-EAQT01_P1',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY': ''
                                })
                                value = state[3].split(".",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[0],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P2',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[11],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': '',
                                    'CONTROL SERVER PORT': '',
                                    'KEEP ALIVE INTERVAL': '',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[3][0:7] + '-EAQT01_P2',
                                    'A MEP NAME': state[3][0:7] + '-EAQT01_P2',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY': ''
                                })
                                if state[4] != '':
                                    value = state[2].split(".",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[0],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P1',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[12],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': '',
                                        'CONTROL SERVER PORT': '',
                                        'KEEP ALIVE INTERVAL': '',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[4][0:7] + '-EAQT01_P1',
                                        'A MEP NAME': state[4][0:7] + '-EAQT01_P1',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY': ''
                                    })
                                    value = state[2].split(".",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[0],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P2',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[13],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP': '',
                                        'CONTROL SERVER PORT': '',
                                        'KEEP ALIVE INTERVAL': '',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[5][0:7] + '-EAQT01_P2',
                                        'A MEP NAME': state[5][0:7] + '-EAQT01_P2',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY': ''
                                    })
                                    line_count += 1
                                else:
                                    line_count += 1
                                    continue
                            if "-" in state[2]:
                                value = state[2].split("-",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[2] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[1],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P1',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[10],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': '',
                                    'CONTROL SERVER PORT': '',
                                    'KEEP ALIVE INTERVAL': '',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[2][0:7] + '-EAQT01_P1',
                                    'A MEP NAME': state[2][0:7] + '-EAQT01_P1',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY' : ''
                                })
                                value = state[3].split("-",1)
                                output_file_writer.writerow({
                                    'F/FLOW': 'F',
                                    'ACTION': 'include',
                                    'Status': 'new',
                                    'UNIQUE FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW ID': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FLOW NAME': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT ID 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'CIRCUIT NAME 1': state[3] + '-' + row[0] + '-Data-Flow',
                                    'FD 1/2 WAY': '2',
                                    'FDV 1/2 WAY': '2',
                                    'CUSTOMER/PROVIDER': 'Claro',
                                    'LEVEL 1': state[1],
                                    'LEVEL 2': state[6],
                                    'LEVEL 3': row[0][-5:-2],
                                    'LEVEL 4': row[0],
                                    'LEVEL 5': value[1],
                                    'SLA PROFILE': 'SLA-' + state[1],
                                    'DEVICE LOCATION A/Z?': 'A',
                                    'A/Z BOTH': 'Both',
                                    'A NAME': 'LTE',
                                    'Z NAME': row[0],
                                    'CIR A->Z': '',
                                    'EIR A->Z': '',
                                    'CIR Z->A': '',
                                    'EIR Z->A': '',
                                    'TEST TYPE': 'twamp',
                                    'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[8] + ' - P2',
                                    'ENDPOINT ROLE': 'initiator',
                                    'ENDPOINT TYPE': 'qt',
                                    'ENDPOINT INTERFACE': '',
                                    'VLAN 1 ETHERTYPE': '8100',
                                    'VLAN 1 ID': state[11],
                                    'RX VLAN 1 PRIORITY': '255',
                                    'PM VLAN 1 PRIORITY': '0',
                                    'VLAN 2 ETHERTYPE': '',
                                    'VLAN 2 ID': '',
                                    'RX VLAN 2 PRIORITY': '0',
                                    'PM VLAN 2 PRIORITY': '0',
                                    'TWAMP TX PERIOD': '100ms',
                                    'TWAMP FRAME SIZE': '87',
                                    'REFLECTOR IP ADDRESS': row[2],
                                    'REFLECTOR SHARED IP': '',
                                    'REFLECTOR UDP PORT': state[15],
                                    'DSCP': state[16],
                                    'CODEC': '',
                                    'CONTROL SERVER IP': '',
                                    'CONTROL SERVER PORT': '',
                                    'KEEP ALIVE INTERVAL': '',
                                    'SOURCE IP ADDRESS': '',
                                    'INITIATOR SHARED IP': '',
                                    'GATEWAY IP ADDRESS': '',
                                    'PREFIX LENGTH': '',
                                    'SOURCE UDP PORT': '',
                                    'DESTINATION MAC ADDRESS': '',
                                    'REMOTE ENDPOINT TYPE': '',
                                    'REMOTE ENDPOINT NAME': '',
                                    'REMOTE ENDPOINT INTERFACE': '',
                                    'MAC ADDRESS': '',
                                    'REMOTE MAC ADDRESS': '',
                                    'MEP NUMERIC ID': '',
                                    'REMOTE MEP ID': '',
                                    'MEP STANDARD': '',
                                    'MD NAME FORMAT': '',
                                    'MD NAME': '',
                                    'MEG ID FORMAT': '',
                                    'MEG ID': '',
                                    'MEG LEVEL': '',
                                    'RX FILTER TYPE': '',
                                    'CCM DEST MAC TYPE': '',
                                    'CCM TX PERIOD': '',
                                    'CCM VLAN 1 PRIORITY': '',
                                    'CCM VLAN 2 PRIORITY': '',
                                    'PM REPORT THROUGHPUT': '',
                                    'PM SAMPLE INTERVAL': 'off',
                                    'DMM TX PERIOD': '',
                                    'SLM TX PERIOD': '',
                                    'DMM DATA TLV SIZE': '',
                                    'SLM DATA TLV SIZE': '',
                                    'DERIVE 1 WAY FROM 2 WAY': 'N',
                                    'FLOW_TIMEZONE': 'America/Fortaleza',
                                    'COMP THRESHOLD FWD LIMITER': '',
                                    'A FIRMWARE VERSION': '',
                                    'A HW VERSION': '',
                                    'A SERIAL NUMBER': '',
                                    'A CLLI': '',
                                    'Z FIRMWARE VERSION': '',
                                    'Z HW VERSION': '',
                                    'Z SERIAL NUMBER': '',
                                    'Z CLLI': '',
                                    'A LOCATIONTYPE': '',
                                    'A LOCATION ADDRESS 1': '',
                                    'A LOCATION ADDRESS 2': '',
                                    'A LOCATION CITY': '',
                                    'A LOCATION STATE': row[1],
                                    'A LOCATION ZIP/POSTAL CODE': '',
                                    'A LOCATION COUNTRY': '',
                                    'Z LOCATIONTYPE': '',
                                    'Z LOCATION ADDRESS 1': '',
                                    'Z LOCATION ADDRESS 2': '',
                                    'Z LOCATION CITY': '',
                                    'Z LOCATION STATE': '',
                                    'Z LOCATION ZIP/POSTAL CODE': '',
                                    'Z LOCATION COUNTRY': '',
                                    'A LATITUDE': '',
                                    'A LONGITUDE': '',
                                    'A ELEVATION': '',
                                    'Z LATITUDE': '',
                                    'Z LONGITUDE': '',
                                    'Z ELEVATION': '',
                                    'A ADDRESS': '',
                                    'A MEP ID': state[3][0:7] + '-EAQT01_P2',
                                    'A MEP NAME': state[3][0:7] + '-EAQT01_P2',
                                    'A PORT ID': '',
                                    'A PORT NAME': '',
                                    'Z ADDRESS': '',
                                    'Z MEP ID': row[2],
                                    'Z MEP NAME': row[2],
                                    'Z PORT ID': row[2] + ':5000',
                                    'Z PORT NAME': row[2] + ':5000',
                                    'A VLAN 1 ID': '',
                                    'A VLAN 1 PRIORITY': '',
                                    'A VLAN 2 ID': '',
                                    'A VLAN 2 PRIORITY': '',
                                    'Z VLAN 1 ID': '',
                                    'Z VLAN 1 PRIORITY': '',
                                    'Z VLAN 2 ID': '',
                                    'Z VLAN 2 PRIORITY' : ''
                                })
                                if state[4] != '':
                                    value = state[2].split("-",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[4] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[1],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P1',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[12],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP':  '',
                                        'CONTROL SERVER PORT': '',
                                        'KEEP ALIVE INTERVAL': '',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[4][0:7] + '-EAQT01_P1',
                                        'A MEP NAME': state[4][0:7] + '-EAQT01_P1',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY' : ''
                                    })
                                    value = state[3].split("-",1)
                                    output_file_writer.writerow({
                                        'F/FLOW': 'F',
                                        'ACTION': 'include',
                                        'Status': 'new',
                                        'UNIQUE FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW ID': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FLOW NAME': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT ID 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'CIRCUIT NAME 1': state[5] + '-' + row[0] + '-Data-Flow',
                                        'FD 1/2 WAY': '2',
                                        'FDV 1/2 WAY': '2',
                                        'CUSTOMER/PROVIDER': 'Claro',
                                        'LEVEL 1': state[1],
                                        'LEVEL 2': state[7],
                                        'LEVEL 3': row[0][-5:-2],
                                        'LEVEL 4': row[0],
                                        'LEVEL 5': value[1],
                                        'SLA PROFILE': 'SLA-' + state[1],
                                        'DEVICE LOCATION A/Z?': 'A',
                                        'A/Z BOTH': 'Both',
                                        'A NAME': 'LTE',
                                        'Z NAME': row[0],
                                        'CIR A->Z': '',
                                        'EIR A->Z': '',
                                        'CIR Z->A': '',
                                        'EIR Z->A': '',
                                        'TEST TYPE': 'twamp',
                                        'ENDPOINT LOGICAL NAME': 'Claro LTE - ' + state[9] + ' - P2',
                                        'ENDPOINT ROLE': 'initiator',
                                        'ENDPOINT TYPE': 'qt',
                                        'ENDPOINT INTERFACE': '',
                                        'VLAN 1 ETHERTYPE': '8100',
                                        'VLAN 1 ID': state[13],
                                        'RX VLAN 1 PRIORITY': '255',
                                        'PM VLAN 1 PRIORITY': '0',
                                        'VLAN 2 ETHERTYPE': '',
                                        'VLAN 2 ID': '',
                                        'RX VLAN 2 PRIORITY': '0',
                                        'PM VLAN 2 PRIORITY': '0',
                                        'TWAMP TX PERIOD': '100ms',
                                        'TWAMP FRAME SIZE': '87',
                                        'REFLECTOR IP ADDRESS': row[2],
                                        'REFLECTOR SHARED IP': '',
                                        'REFLECTOR UDP PORT': state[15],
                                        'DSCP': state[16],
                                        'CODEC': '',
                                        'CONTROL SERVER IP':  '',
                                        'CONTROL SERVER PORT': '',
                                        'KEEP ALIVE INTERVAL': '',
                                        'SOURCE IP ADDRESS': '',
                                        'INITIATOR SHARED IP': '',
                                        'GATEWAY IP ADDRESS': '',
                                        'PREFIX LENGTH': '',
                                        'SOURCE UDP PORT': '',
                                        'DESTINATION MAC ADDRESS': '',
                                        'REMOTE ENDPOINT TYPE': '',
                                        'REMOTE ENDPOINT NAME': '',
                                        'REMOTE ENDPOINT INTERFACE': '',
                                        'MAC ADDRESS': '',
                                        'REMOTE MAC ADDRESS': '',
                                        'MEP NUMERIC ID': '',
                                        'REMOTE MEP ID': '',
                                        'MEP STANDARD': '',
                                        'MD NAME FORMAT': '',
                                        'MD NAME': '',
                                        'MEG ID FORMAT': '',
                                        'MEG ID': '',
                                        'MEG LEVEL': '',
                                        'RX FILTER TYPE': '',
                                        'CCM DEST MAC TYPE': '',
                                        'CCM TX PERIOD': '',
                                        'CCM VLAN 1 PRIORITY': '',
                                        'CCM VLAN 2 PRIORITY': '',
                                        'PM REPORT THROUGHPUT': '',
                                        'PM SAMPLE INTERVAL': 'off',
                                        'DMM TX PERIOD': '',
                                        'SLM TX PERIOD': '',
                                        'DMM DATA TLV SIZE': '',
                                        'SLM DATA TLV SIZE': '',
                                        'DERIVE 1 WAY FROM 2 WAY': 'N',
                                        'FLOW_TIMEZONE': 'America/Fortaleza',
                                        'COMP THRESHOLD FWD LIMITER': '',
                                        'A FIRMWARE VERSION': '',
                                        'A HW VERSION': '',
                                        'A SERIAL NUMBER': '',
                                        'A CLLI': '',
                                        'Z FIRMWARE VERSION': '',
                                        'Z HW VERSION': '',
                                        'Z SERIAL NUMBER': '',
                                        'Z CLLI': '',
                                        'A LOCATIONTYPE': '',
                                        'A LOCATION ADDRESS 1': '',
                                        'A LOCATION ADDRESS 2': '',
                                        'A LOCATION CITY': '',
                                        'A LOCATION STATE': row[1],
                                        'A LOCATION ZIP/POSTAL CODE': '',
                                        'A LOCATION COUNTRY': '',
                                        'Z LOCATIONTYPE': '',
                                        'Z LOCATION ADDRESS 1': '',
                                        'Z LOCATION ADDRESS 2': '',
                                        'Z LOCATION CITY': '',
                                        'Z LOCATION STATE': '',
                                        'Z LOCATION ZIP/POSTAL CODE': '',
                                        'Z LOCATION COUNTRY': '',
                                        'A LATITUDE': '',
                                        'A LONGITUDE': '',
                                        'A ELEVATION': '',
                                        'Z LATITUDE': '',
                                        'Z LONGITUDE': '',
                                        'Z ELEVATION': '',
                                        'A ADDRESS': '',
                                        'A MEP ID': state[5][0:7] + '-EAQT01_P2',
                                        'A MEP NAME': state[5][0:7] + '-EAQT01_P2',
                                        'A PORT ID': '',
                                        'A PORT NAME': '',
                                        'Z ADDRESS': '',
                                        'Z MEP ID': row[2],
                                        'Z MEP NAME': row[2],
                                        'Z PORT ID': row[2] + ':5000',
                                        'Z PORT NAME': row[2] + ':5000',
                                        'A VLAN 1 ID': '',
                                        'A VLAN 1 PRIORITY': '',
                                        'A VLAN 2 ID': '',
                                        'A VLAN 2 PRIORITY': '',
                                        'Z VLAN 1 ID': '',
                                        'Z VLAN 1 PRIORITY': '',
                                        'Z VLAN 2 ID': '',
                                        'Z VLAN 2 PRIORITY' : ''
                                    })
                                    line_count += 1
                                else:
                                    line_count += 1
                                    continue
                        else:
                            continue
                else:
                    continue

        print(f'Processed {line_count} lines from {state[14]}')

# %%
# RUN FUNCTIONS
insert_header()
generate_flows(ma)
generate_flows(rj)
generate_flows(sp1)
generate_flows(sp2)
generate_flows(rs)
generate_flows(es)
generate_flows(ce)
generate_flows(pe)
generate_flows(pb)
generate_flows(pi)

generate_flows(se)
generate_flows(df)
generate_flows(ac)
generate_flows(go)
generate_flows(mt)
generate_flows(ms)
generate_flows(ro)
generate_flows(to)
generate_flows(mg)
generate_flows(am)
generate_flows(pa)
generate_flows(ap)
generate_flows(rr)
generate_flows(pr)
generate_flows(sc)
generate_flows(ba)
generate_flows(al)
generate_flows(rn)

# %%
df3 = pd.read_csv(outputfile, sep=",", dtype=str , low_memory=True)

# %%
print(df3.groupby('LEVEL 1')['LEVEL 4'].nunique())
print(df3.groupby('LEVEL 2')['LEVEL 4'].nunique())
print(df3.groupby('LEVEL 5')['LEVEL 4'].nunique())

# %%
# Total Lines
total = len(df3.index)
print(f'Total lines : {total:,}')


